<html>

    <input>
    <nav>
        <ul>
            <li><a href="departments.html">Departments</a></li>
            <li><a href="employees.html">Employees</a></li>
            <li><a href="shifts.html">Shifts</a></li>
            <li><a href="users.html">Users</a></li>
        </ul>
    </nav>
    <button onclick="logout()">Log Out</button>

    <h1>Shifts</h1>
    <label for="date">Date</label>
    <input type="date" id="date">
    <br />
    <br />
    <label for="start">Starts at:</label>
    <input type="time" id="start">
    <label for="end">Ends at:</label>
    <input type="time" id="end">
    <br />
    <br />
    <br />
    <button onclick="add(event)">Add Shift</button>
    <script>
        const shiftUrl = "http://localhost:4000/shift";

        const options = {
            headers: {
                "access-Token": sessionStorage.getItem('accessToken')
            }
        }
        async function add(e) {
            e.preventDefault();
            const date = new Date(document.getElementById('date').value);
            const start = document.getElementById('start').value
            const end = document.getElementById('end').value
            const formatedDate = date.toISOString();
            const formatedStart = formatHour(start)
            const formatedEnd = formatHour(end)
            console.log(formatedStart, formatedEnd);

            const obj = { date: date, start: formatedStart, end: formatedEnd, employeesList: [] }

            try {
                const resp = await fetch(`${shiftUrl}/add`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json", "access-Token": sessionStorage.getItem('accessToken') },
                    body: JSON.stringify(obj),
                })
                const data = await resp.json();

                window.location = './employees.html'
            } catch (error) {
                console.error(error);
            }
        }

        function formatHour(hour) {
            const [h, m] = hour.split(':');
            return `${h}${m}`;
        }
        function logout() {
            sessionStorage.clear()
            window.location = "login.html"
        }
    </script>
    </body>

</html>
